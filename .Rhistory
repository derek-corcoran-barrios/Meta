dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Behavior, vtype = "UB")
res <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
nullmod <- data.frame(estimate = res$b, ci.ub = res$ci.ub, ci.lb = res$ci.lb, group = c("Null"), p = res$pval, n =nrow(Behavior))
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  factor(Nesting.Area) - 1, slab = paste(dat1$Authors, dat1$Year))
Nesting <- data.frame(estimate = res1$b, ci.ub = res1$ci.ub, ci.lb = res1$ci.lb, group = c("aboveground", "both", "ground"), p = res1$pval, n = c(length(dplyr::filter(Behavior, Nesting.Area == "aboveground")$Nesting.Area), length(dplyr::filter(Behavior, Nesting.Area == "both")$Nesting.Area), length(dplyr::filter(Behavior, Nesting.Area == "ground")$Nesting.Area)))
All <- rbind(nullmod, Nesting)
knitr::kable(All, digits = 3, row.names = FALSE)
Meta_Data <- read.csv("~/Documents/Meta/Meta/Meta_MasterDataNEW.csv")
View(Meta_Data)
Meta <- Meta_Data
library(ggplot2)
ggplot(Meta, aes(x=reorder(Fitness.measure,Fitness.measure, function(x)-length(x)))) + geom_bar() + xlab("Performance measure") + ylab("Number of studies") + theme_classic()
ggplot(Meta, aes(x=reorder(Fitness.measure,Fitness.measure, function(x)-length(x)))) + geom_bar(aes(fill = Functional.group), position = "dodge")+ xlab("Performance measure") + ylab("Number of studies") + theme_classic()
ggplot(Meta, aes(x=reorder(Fitness.measure,Fitness.measure, function(x)-length(x)))) + geom_bar(aes(fill = Order), position = "dodge")+ xlab("Performance measure") + ylab("Number of studies") + theme_classic()
ggplot(Meta, aes(x=reorder(Fitness.measure,Fitness.measure, function(x)-length(x)))) + geom_bar(aes(fill = Study.Type), position = "dodge")+ xlab("Performance measure") + ylab("Number of studies") + theme_classic()
ggplot(Meta, aes(x=reorder(Fitness.measure,Fitness.measure, function(x)-length(x)))) + geom_bar(aes(fill = Foraging.Area), position = "dodge")+ xlab("Performance measure") + ylab("Number of studies") + theme_classic()
ggplot(Meta, aes(x=reorder(Fitness.measure,Fitness.measure, function(x)-length(x)))) + geom_bar(aes(fill = Nesting.Area), position = "dodge")+ xlab("Performance measure") + ylab("Number of studies") + theme_classic()
library(metafor)
#Abundance
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
res <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
Abund <- data.frame(estimate = res$b, ci.ub = res$ci.ub, ci.lb = res$ci.lb, group = c("Abundance"), p = res$pval, n =nrow(Abundance))
#Behavior
Behavior <- dplyr::filter(Meta, Fitness.measure == "behavior")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Behavior, vtype = "UB")
res2 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
Behav <- data.frame(estimate = res2$b, ci.ub = res2$ci.ub, ci.lb = res2$ci.lb, group = c("Behavior"), p = res2$pval, n =nrow(Behavior))
#Survival
survival <- dplyr::filter(Meta, Fitness.measure == "survival")
Meta_Data <- read.csv("~/Documents/Meta/Meta/Meta_MasterDataNEW.csv")
View(Meta_Data)
Meta <- Meta_Data
library(ggplot2)
ggplot(Meta, aes(x=reorder(Fitness.measure,Fitness.measure, function(x)-length(x)))) + geom_bar() + xlab("Performance measure") + ylab("Number of studies") + theme_classic()
ggplot(Meta, aes(x=reorder(Fitness.measure,Fitness.measure, function(x)-length(x)))) + geom_bar(aes(fill = Functional.group), position = "dodge")+ xlab("Performance measure") + ylab("Number of studies") + theme_classic()
ggplot(Meta, aes(x=reorder(Fitness.measure,Fitness.measure, function(x)-length(x)))) + geom_bar(aes(fill = Order), position = "dodge")+ xlab("Performance measure") + ylab("Number of studies") + theme_classic()
ggplot(Meta, aes(x=reorder(Fitness.measure,Fitness.measure, function(x)-length(x)))) + geom_bar(aes(fill = Study.Type), position = "dodge")+ xlab("Performance measure") + ylab("Number of studies") + theme_classic()
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
res <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
str(Abundance)
Meta$Con_Mean <- as.numeric(as.character(Meta$Con_Mean))
Meta$Con_Mean
View(Meta_Data)
Meta_Data <- read.csv("~/Documents/Meta/Meta/Meta_MasterDataNEW.csv")
View(Meta_Data)
Meta <- Meta_Data
str(Meta)
library(metafor)
#Abundance
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
res <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
Abund <- data.frame(estimate = res$b, ci.ub = res$ci.ub, ci.lb = res$ci.lb, group = c("Abundance"), p = res$pval, n =nrow(Abundance))
#Behavior
Behavior <- dplyr::filter(Meta, Fitness.measure == "behavior")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Behavior, vtype = "UB")
res2 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
Behav <- data.frame(estimate = res2$b, ci.ub = res2$ci.ub, ci.lb = res2$ci.lb, group = c("Behavior"), p = res2$pval, n =nrow(Behavior))
#Survival
survival <- dplyr::filter(Meta, Fitness.measure == "survival")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=survival, vtype = "UB")
res3 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
Surviv <- data.frame(estimate = res3$b, ci.ub = res3$ci.ub, ci.lb = res3$ci.lb, group = c("Survival"), p = res3$pval, n =nrow(survival))
#Reproduction
reproduction <- dplyr::filter(Meta, Fitness.measure == "reproduction")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=reproduction, vtype = "UB")
res4 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
Reprod <- data.frame(estimate = res4$b, ci.ub = res4$ci.ub, ci.lb = res4$ci.lb, group = c("Reproduction"), p = res4$pval, n =nrow(reproduction))
#Condition
condition <- dplyr::filter(Meta, Fitness.measure == "condition")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=condition, vtype = "UB")
res4 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
Cond <- data.frame(estimate = res4$b, ci.ub = res4$ci.ub, ci.lb = res4$ci.lb, group = c("Condition"), p = res4$pval, n =nrow(condition))
All <- rbind(Abund, Behav, Surviv, Reprod, Cond)
knitr::kable(All, digits = 3, row.names = FALSE)
All <- All[-4,]
ggplot(All, aes(x = group, y = estimate)) + geom_point(aes(size = n)) + coord_flip() + geom_errorbar(aes(ymin=ci.lb, ymax=ci.ub),width=0.0) + geom_hline(yintercept = 0, linetype=2) + ylim(c(-10, 10)) + ylab(c("Standardized Mean Difference")) + theme_classic() + xlab(c(""))
```
library(meta)
library(metafor)
###########Examples
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
res <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
nullmod <- data.frame(estimate = res$b, ci.ub = res$ci.ub, ci.lb = res$ci.lb, group = c("Null"), p = res$pval, n =nrow(Abundance))
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  factor(Functional.group) - 1, slab = paste(dat1$Authors, dat1$Year))
res1
nullmod <- data.frame(estimate = res$b, ci.ub = res$ci.ub, ci.lb = res$ci.lb, group = c("Null"), p = res$pval, n =nrow(Abundance))
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  factor(Functional.group) - 1, slab = paste(dat1$Authors, dat1$Year))
functionalgroup <- data.frame(estimate = res1$b, ci.ub = res1$ci.ub, ci.lb = res1$ci.lb, group = c("detritivore","mixed", "omnivore", "pollinator", "predator"), p = res1$pval, n = c(length(dplyr::filter(Abundance, Functional.group == "detritivore")$Functional.group),length(dplyr::filter(Abundance, Functional.group == "mixed")$Functional.group), length(dplyr::filter(Abundance, Functional.group == "omnivore")$Functional.group), length(dplyr::filter(Abundance, Functional.group == "pollinator")$Functional.group), length(dplyr::filter(Abundance, Functional.group == "predator")$Functional.group)))
All <- rbind(nullmod, functionalgroup)
knitr::kable(All, digits = 3, row.names = FALSE)
ggplot(All, aes(x = group, y = estimate)) + geom_point(aes(size = n)) + coord_flip() + geom_errorbar(aes(ymin=ci.lb, ymax=ci.ub),width=0.0) + geom_hline(yintercept = 0, linetype=2) + ylim(c(-6, 6)) + ylab(c("Standardized Mean Difference")) + theme_classic() + xlab(c(""))
Meta_Data <- read.csv("~/Documents/Meta/Meta/Meta_MasterDataNEW.csv")
View(Meta_Data)
saveRDS(Meta_Data, "Meta_data.rds")
Meta <- readRDS("Meta_data.rds")
View(Meta)
library(metafor)
#Abundance
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
View(dat1)
res <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
res
?rma
res <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
Abund <- data.frame(estimate = res$b, ci.ub = res$ci.ub, ci.lb = res$ci.lb, group = c("Abundance"), p = res$pval, n =nrow(Abundance))
View(Abund)
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  factor(Functional.group) - 1, slab = paste(dat1$Authors, dat1$Year))
res1
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  factor(Functional.group) - 1, slab = paste(dat1$Authors, dat1$Year))
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  factor(AI.type) - 1, slab = paste(dat1$Authors, dat1$Year))
res1
test <- dplyr::group_by(Abundance, AI.type)
test <- dplyr::summarise(test, n())
View(test)
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~ factor(Functional.group) + factor(AI.type) - 1, slab = paste(dat1$Authors, dat1$Year))
res1
?predict.rma
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~ T1_ppb + factor(Functional.group) + factor(AI.type) - 1, slab = paste(dat1$Authors, dat1$Year))
res1
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~ T1_ppb, slab = paste(dat1$Authors, dat1$Year))
res1
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~ T1_ppb + factor(Treatment.2) - 1, slab = paste(dat1$Authors, dat1$Year))
res1
Behavior <- dplyr::filter(Meta, Fitness.measure == "behavior")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Behavior, vtype = "UB")
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~ T1_ppb + factor(Treatment.2) - 1, slab = paste(dat1$Authors, dat1$Year))
res1
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~ T1_ppb - 1, slab = paste(dat1$Authors, dat1$Year))
res1
survival <- dplyr::filter(Meta, Fitness.measure == "survival")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=survival, vtype = "UB")
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~ T1_ppb - 1, slab = paste(dat1$Authors, dat1$Year))
res1
summary(Meta$T1_ppb)
is.na(Meta$T1_ppb)
!is.na(Meta$T1_ppb)
sum(!is.na(Meta$T1_ppb))
test <- Meta[!is.na(Meta$T1_ppb),]
View(test)
test <- dplyr::group_by(test, AI.type)
test <- dplyr::summarise(test, n())
View(test)
test <- Meta[!is.na(Meta$T1_ppb),]
test <- dplyr::group_by(test, Fitness.measure)
test <- dplyr::summarise(test, n())
View(test)
test <- Meta[!is.na(Meta$T1_ppb),]
test <- dplyr::group_by(test, Fitness.measure)
test <- dplyr::summarise(test, n(), MAX = max(T1_ppb), MIN = min(T1_ppb))
View(test)
View(Meta[Meta$T1_ppb == min(Meta$T1_ppb, na.rm = TRUE),])
min(Meta$T1_ppb, na.rm = TRUE)
sum(Meta$T1_ppb == min(Meta$T1_ppb, na.rm = TRUE))
sum(Meta$T1_ppb == min(Meta$T1_ppb, na.rm = TRUE), na.rm = TRUE)
Meta_MasterDataNEW <- read.csv("~/Documents/Meta/Meta/Meta_MasterDataNEW.csv")
View(Meta_MasterDataNEW)
saveRDS(Meta_MasterDataNEW, "Meta_data.rds")
Meta <- readRDS("Meta_data.rds")
test <- Meta[!is.na(Meta$T1_ppb),]
test <- dplyr::group_by(test, Fitness.measure)
test <- dplyr::summarise(test, n(), MAX = max(T1_ppb), MIN = min(T1_ppb))
View(test)
test <- Meta[!is.na(Meta$T1_ppb),]
test <- dplyr::group_by(test, Fitness.measure, AI.type)
test <- dplyr::summarise(test, n(), MAX = max(T1_ppb), MIN = min(T1_ppb))
View(test)
test <- Meta[!is.na(Meta$T1_ppb),]
test <- dplyr::group_by(test, Fitness.measure, Treatment.2)
test <- dplyr::summarise(test, n(), MAX = max(T1_ppb), MIN = min(T1_ppb))
View(test)
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Meta, vtype = "UB")
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  factor(Fitness.measure) - 1, slab = paste(dat1$Authors, dat1$Year))
res1
?escalv
?escalc
Meta <- read.csv("~/Documents/Meta/Meta/Meta_MasterDataNEW_March 5.csv")
View(Meta)
str(Meta)
Meta <- read.csv("~/Documents/Meta/Meta/Meta_MasterDataNEW_March 5.csv")
View(Meta)
str(Meta)
Meta <- read.csv("~/Documents/Meta/Meta/Meta_MasterDataNEW_March 5.csv")
View(Meta)
str(Meta)
saveRDS(Meta, "Meta.rds")
library(metafor)
citation("metafor")
?escalc
citation
citation()
citation("base")
meta <- readRDS("meta.rds")
meta <- readRDS("Meta.rds")
View(meta)
temp <- dplyr::group_by(Fitness.measure)
temp <- dplyr::group_by(meta, Fitness.measure)
temp <- dplyr::summarise(temp, n())
temp
Meta <- readRDS("Meta.rds")
library(ggplot2)
library(metafor)
library(metafor)
#Abundance
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
res <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
res$QE
res$QEp
res$R2
res$tau2
library(metafor)
#Abundance
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
res <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
Abund <- data.frame(estimate = res$b, ci.ub = res$ci.ub, ci.lb = res$ci.lb, group = c("Abundance"), p = res$pval, n =nrow(Abundance), Tau= res$tau2, p-valCT = res$QEp)
Abund <- data.frame(estimate = res$b, ci.ub = res$ci.ub, ci.lb = res$ci.lb, group = c("Abundance"), p = res$pval, n =nrow(Abundance), Tau= res$tau2, pvalCT = res$QEp)
Abund
res$I2
res
confint(res)
res$I2
res$IH2
res$H2
library(metafor)
#Abundance
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
res <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
Abund <- data.frame(estimate = res$b, ci.ub = res$ci.ub, ci.lb = res$ci.lb, group = c("Abundance"), p = res$pval, n =nrow(Abundance), I2= res$I2, pvalCT = res$QEp)
#Behavior
Abund
Behavior <- dplyr::filter(Meta, Fitness.measure == "behavior")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Behavior, vtype = "UB")
res2 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
Behav <- data.frame(estimate = res2$b, ci.ub = res2$ci.ub, ci.lb = res2$ci.lb, group = c("Behavior"), p = res2$pval, n =nrow(Behavior), I2= res2$I2, pvalCT = res2$QEp)
Behav
survival <- dplyr::filter(Meta, Fitness.measure == "survival")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=survival, vtype = "UB")
res3 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
Surviv <- data.frame(estimate = res3$b, ci.ub = res3$ci.ub, ci.lb = res3$ci.lb, group = c("Survival"), p = res3$pval, n =nrow(survival), I2= res3$I2, pvalCT = res3$QEp)
Surviv
reproduction <- dplyr::filter(Meta, Fitness.measure == "reproduction")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=reproduction, vtype = "UB")
res4 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
Reprod <- data.frame(estimate = res4$b, ci.ub = res4$ci.ub, ci.lb = res4$ci.lb, group = c("Reproduction"), p = res4$pval, n =nrow(reproduction), I2= res4$I2, pvalCT = res4$QEp)
Reprod
condition <- dplyr::filter(Meta, Fitness.measure == "condition")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=condition, vtype = "UB")
res5 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
Cond <- data.frame(estimate = res5$b, ci.ub = res5$ci.ub, ci.lb = res5$ci.lb, group = c("Condition"), p = res5$pval, n =nrow(condition), I2= res5$I22, pvalCT = res5$QEp)
Cond <- data.frame(estimate = res5$b, ci.ub = res5$ci.ub, ci.lb = res5$ci.lb, group = c("Condition"), p = res5$pval, n =nrow(condition), I2= res5$I2, pvalCT = res5$QEp)
All <- rbind(Abund, Behav, Surviv, Reprod, Cond)
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
library(metafor)
#Abundance
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
Meta <- readRDS("Meta.rds")
library(ggplot2)
library(metafor)
ggplot(Meta, aes(x=reorder(Fitness.measure,Fitness.measure, function(x)-length(x)))) + geom_bar() + xlab("Performance measure") + ylab("Number of studies") + theme_classic()
library(metafor)
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
View(dat1)
ggplot(dat1, aes(x = T1_ppb, y = yi)) + geom_point()
ggplot(dat1, aes(x = T1_ppb, y = yi)) + geom_point() + geom_smooth(method = "lm")
summary(lm(yi~t1_ppb, data = dat1))
summary(lm(yi~T1_ppb, data = dat1))
summary(lm(yi~T1_ppb, data = dat1)$residuals)
hist(lm(yi~T1_ppb, data = dat1)$residuals)
Behavior <- dplyr::filter(Meta, Fitness.measure == "behavior")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Behavior, vtype = "UB")
ggplot(dat1, aes(x = T1_ppb, y = yi)) + geom_point() + geom_smooth(method = "lm")
survival <- dplyr::filter(Meta, Fitness.measure == "survival")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=survival, vtype = "UB")
ggplot(dat1, aes(x = T1_ppb, y = yi)) + geom_point() + geom_smooth(method = "lm")
reproduction <- dplyr::filter(Meta, Fitness.measure == "reproduction")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=reproduction, vtype = "UB")
ggplot(dat1, aes(x = T1_ppb, y = yi)) + geom_point() + geom_smooth(method = "lm")
condition <- dplyr::filter(Meta, Fitness.measure == "condition")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=condition, vtype = "UB")
ggplot(dat1, aes(x = T1_ppb, y = yi)) + geom_point() + geom_smooth(method = "lm")
Abundance
View(Abundance)
Ab <- Abundance[!is.na(Abundance$T1_SE),]
View(Ab)
sum(!is.na(Abundance$T1_SE))
sum(!is.na(Abundance$T1_ppb))
sum(!is.na(Abundance$T2_ppb))
Ab <- Abundance[!is.na(Abundance$T1_ppb),]
Ab <- Meta[!is.na(Meta$T1_ppb),]
sum(Meta[!is.na(Meta$T1_ppb),])
sum(!is.na(Meta$T1_ppb))
sum(!is.na(Meta$T2_ppb))
Ab <- Meta[!is.na(Meta$T2_ppb),]
View(Ab)
summary(AB$Fitness.measure)
summary(Ab$Fitness.measure)
Meta <- readRDS("Meta.rds")
library(ggplot2)
library(metafor)
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
res <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
nullmod <- data.frame(estimate = res$b, ci.ub = res$ci.ub, ci.lb = res$ci.lb, group = c("Null"), p = res$pval, n =nrow(Abundance))
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  factor(Functional.group) - 1, slab = paste(dat1$Authors, dat1$Year))
res1
res1$QEp
res1$QMp
res1$R2
res1$tau2
res1
(0.3132 âˆ’ 0.1108)/.3132
(0.3132 - 0.1108)
(0.3132 - 0.1108)/0.3132
2.274
2.2744
2.2744-5.1854
(2.2744-5.1854)/2.2774
summary(res1)
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
Abundance <- Abundance[!is.na(Abundance$T1_ppb),]
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  T1_ppb, slab = paste(dat1$Authors, dat1$Year))
res1
res2 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  T1_ppb +  factor(Functional.group), slab = paste(dat1$Authors, dat1$Year))
res2
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
Abundance <- Abundance[!is.na(Abundance$T1_ppb),]
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  T1_ppb, slab = paste(dat1$Authors, dat1$Year))
predict(res1, newmods = cbind(seq(from = min(dat1$T1_ppb), to = max(dat1$T1_ppb), length.out =  20)), addx = TRUE)
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
Abundance <- Abundance[!is.na(Abundance$T1_ppb),]
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  T1_ppb, slab = paste(dat1$Authors, dat1$Year))
#res2 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  T1_ppb +  factor(Functional.group), slab = paste(dat1$Authors, dat1$Year))
preds <- predict(res1, newmods = cbind(seq(from = min(dat1$T1_ppb), to = max(dat1$T1_ppb), length.out =  20)), addx = TRUE)
ggplot(dat1, aes(x = T1_ppb, y = yi)) + geom_point()
preds
class(preds)
preds <- as.data.frame(preds)
str(preds)
preds$X
preds$X$T1_ppb
preds$X
str(preds$X)
str(preds$X[[2]])
str(preds$X[[1]])
str(preds$X
)
class(preds$X)
class(preds$X[,1])
preds$X[,1]
preds$X[,2]
preds <- data.frame(pred = preds$pred, ci.lb = preds$ci.lb, ci.ub = preds$ci.ub, X.T1_ppb = preds$X[,2]
)
ggplot(dat1, aes(x = T1_ppb, y = yi)) + geom_point() + geom_line(data = preds, aes(x = X.T1_ppb, y = pred)) + geom_ribbon(data = preds, aes(ymin = ci.lb, ymax = ci.ub)) + theme_classic()
ggplot(dat1, aes(x = T1_ppb, y = yi)) + geom_point()
ggplot(dat1, aes(x = T1_ppb, y = yi)) + geom_point() + geom_line(data = preds, aes(x = X.T1_ppb, y = pred)) + geom_ribbon(data = preds, aes(ymin = ci.lb, ymax = ci.ub)) + theme_classic()
ggplot(dat1, aes(x = T1_ppb, y = yi)) + geom_point()
p <- ggplot(dat1, aes(x = T1_ppb, y = yi)) + geom_point()
p
p + + geom_line(data = preds, aes(x = X.T1_ppb, y = pred)) + geom_ribbon(data = preds, aes(ymin = ci.lb, ymax = ci.ub)) + theme_classic()
p + geom_line(data = preds, aes(x = X.T1_ppb, y = pred)) + geom_ribbon(data = preds, aes(ymin = ci.lb, ymax = ci.ub)) + theme_classic()
ggplot(dat1, aes(x = T1_ppb, y = yi)) + geom_point() + geom_line(data = preds, aes(x = X.T1_ppb, y = pred)) + geom_ribbon(data = preds, aes(x = X.T1_ppb, ymin = ci.lb, ymax = ci.ub)) + theme_classic()
preds <- predict(res1, newmods = cbind(seq(from = min(dat1$T1_ppb), to = max(dat1$T1_ppb), length.out =  20)), addx = TRUE)
preds
ggplot(dat1, aes(x = T1_ppb, y = yi)) + geom_point() + geom_line(data = preds, aes(x = X.T1_ppb, y = pred)) + geom_ribbon(data = preds, aes(x = X.T1_ppb, y = pred, ymin = ci.lb, ymax = ci.ub)) + theme_classic()
preds <- data.frame(pred = preds$pred, ci.lb = preds$ci.lb, ci.ub = preds$ci.ub, X.T1_ppb = preds$X[,2])
ggplot(dat1, aes(x = T1_ppb, y = yi)) + geom_point() + geom_line(data = preds, aes(x = X.T1_ppb, y = pred)) + geom_ribbon(data = preds, aes(x = X.T1_ppb, y = pred, ymin = ci.lb, ymax = ci.ub)) + theme_classic()
ggplot(dat1, aes(x = T1_ppb, y = yi)) + geom_point()  + geom_ribbon(data = preds, aes(x = X.T1_ppb, y = pred, ymin = ci.lb, ymax = ci.ub)) + theme_classic() + geom_line(data = preds, aes(x = X.T1_ppb, y = pred))
ggplot(dat1, aes(x = T1_ppb, y = yi))  + geom_ribbon(data = preds, aes(x = X.T1_ppb, y = pred, ymin = ci.lb, ymax = ci.ub)) + theme_classic() + geom_line(data = preds, aes(x = X.T1_ppb, y = pred)) + geom_point()
dat1$Study.T1..n.
ggplot(dat1, aes(x = T1_ppb, y = yi))  + geom_ribbon(data = preds, aes(x = X.T1_ppb, y = pred, ymin = ci.lb, ymax = ci.ub)) + theme_classic() + geom_line(data = preds, aes(x = X.T1_ppb, y = pred)) + geom_point(aes(size =Study.T1..n.))
?geom_hline
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
res <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
nullmod <- data.frame(estimate = res$b, ci.ub = res$ci.ub, ci.lb = res$ci.lb, group = c("Null"), p = res$pval, n =nrow(Abundance))
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  factor(Functional.group) - 1, slab = paste(dat1$Authors, dat1$Year))
Meta <- readRDS("Meta.rds")
library(ggplot2)
library(metafor)
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
res <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
nullmod <- data.frame(estimate = res$b, ci.ub = res$ci.ub, ci.lb = res$ci.lb, group = c("Null"), p = res$pval, n =nrow(Abundance))
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  factor(Functional.group) - 1, slab = paste(dat1$Authors, dat1$Year))
res1
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  factor(Functional.group), slab = paste(dat1$Authors, dat1$Year))
res1
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  factor(Functional.group) - 1, slab = paste(dat1$Authors, dat1$Year))
res1
res1
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  factor(Functional.group), slab = paste(dat1$Authors, dat1$Year))
res1$R2
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
Abundance <- Abundance[!is.na(Abundance$T1_ppb),]
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  T1_ppb, slab = paste(dat1$Authors, dat1$Year))
res1
res1$R2
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
Abundance <- Abundance[!is.na(Abundance$T1_ppb),]
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
res1 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  T1_ppb + factor(Functional.group), slab = paste(dat1$Authors, dat1$Year))
res1$R2
res1
res1$vb
res1$fit.stats
res1$R2
res1$R2/100
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
Abundance <- Abundance[!is.na(Abundance$T1_ppb),]
summary(Abundance)
res1$fit.stats
res1$fit.stats[AICc,]
str(res1$fit.stats)
res1$fit.stats$ML
res1$fit.stats$ML[5]
res1$fit.stats$p
res1$p
res1$QMp
res2 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  T1_ppb, slab = paste(dat1$Authors, dat1$Year))
model2 <- data.frame(model = "y ~ concentration", p_value = res3$QMp, R_squared = v, AICc = res3$fit.stats$ML[5])
model2 <- data.frame(model = "y ~ concentration", p_value = res2$QMp, R_squared = v, AICc = res2$fit.stats$ML[5])
model2 <- data.frame(model = "y ~ concentration", p_value = res2$QMp, R_squared = round(res2$R2/100,2), AICc = res2$fit.stats$ML[5])
model2
seq(from = min(dat1$T1_ppb), to = max(dat1$T1_ppb), length.out =  20)
?expand.grid
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
Abundance <- Abundance[!is.na(Abundance$T1_ppb),]
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
res3 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  T1_ppbfactor(Functional.group), slab = paste(dat1$Authors, dat1$Year))
res3 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  T1_ppb + factor(Functional.group), slab = paste(dat1$Authors, dat1$Year))
model3 <- data.frame(model = "y ~ Concentration + Functional group", p_value = res3$QMp, R_squared = round(res3$R2/100,2), AICc = res3$fit.stats$ML[5])
res3
model3 <- data.frame(model = "y ~ Concentration + Functional group", p_value = res3$QMp, R_squared = round(res3$R2/100,2), AICc = res3$fit.stats$ML[5])
model3
summary(dat1$Functional.group)
expand.grid(T1_ppb = seq(from = min(dat1$T1_ppb), to = max(dat1$T1_ppb), length.out =  20), Functional.group = c("omnivore", "pollinator", "predator"))
preds <- predict(res3, newmods = expand.grid(T1_ppb = seq(from = min(dat1$T1_ppb), to = max(dat1$T1_ppb), length.out =  20), Functional.group = c("omnivore", "pollinator", "predator")), addx = TRUE)
res3 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  T1_ppb + factor(Functional.group), slab = paste(dat1$Authors, dat1$Year))
preds <- predict(res3, newmods = expand.grid(T1_ppb = seq(from = min(dat1$T1_ppb), to = max(dat1$T1_ppb), length.out =  20), Functional.group = c("omnivore", "pollinator", "predator")), addx = TRUE)
preds <- predict(res3, newmods = expand.grid(T1_ppb = seq(from = min(dat1$T1_ppb), to = max(dat1$T1_ppb), length.out =  20), Functional.group = c("pollinator", "predator")), addx = TRUE)
?sort
All <- rbind(model1, model2, model3)
All <- rbind(model2, model3)
All
dplyr::arrange(All, AICc)
summary(dat1$AI.type)
summary(Meta$AI.type)
funnel(res3)
Meta <- readRDS("Meta.rds")
colnames(Meta)
summary(Meta$Nesting.Area)
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
res <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
nullmod <- data.frame(estimate = res$b, ci.ub = res$ci.ub, ci.lb = res$ci.lb, group = c("Null"), p = res$pval, n =nrow(Abundance))
res0 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  factor(Nesting.Area) - 1, slab = paste(dat1$Authors, dat1$Year))
res0
NestingArea <- data.frame(estimate = res0$b, ci.ub = res0$ci.ub, ci.lb = res0$ci.lb, group = c("aboveground","both", "ground"), p = res0$pval, n = c(length(dplyr::filter(Abundance, Functional.group == "aboveground")$Nesting.Area),length(dplyr::filter(Abundance, Functional.group == "both")$Nesting.Area), length(dplyr::filter(Abundance, Functional.group == "ground")$Nesting.Area)))
res6 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  T1_ppb + factor(Nesting.Area) + factor(Functional.group), slab = paste(dat1$Authors, dat1$Year))
res1
res6
res6
res6
Abundance <- dplyr::filter(Meta, Fitness.measure == "abundance")
Abundance <- Abundance[!is.na(Abundance$T1_ppb),]
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Abundance, vtype = "UB")
res3 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  T1_ppb + factor(Functional.group), slab = paste(dat1$Authors, dat1$Year))
#preds <- predict(res3, newmods = expand.grid(T1_ppb = seq(from = min(dat1$T1_ppb), to = max(dat1$T1_ppb), length.out =  20), Functional.group = c("omnivore", "pollinator", "predator")), addx = TRUE)
#preds <- data.frame(pred = preds$pred, ci.lb = preds$ci.lb, ci.ub = preds$ci.ub, X.T1_ppb = preds$X[,2])
model3 <- data.frame(model = "y ~ Concentration + Functional group", p_value = res3$QMp, R_squared = round(res3$R2/100,2), AICc = res3$fit.stats$ML[5])
res3
Behavior <- dplyr::filter(Meta, Fitness.measure == "behavior")
Behavior$AI.type
res0 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  factor(AI.type) - 1, slab = paste(dat1$Authors, dat1$Year))
summary(Behavior$AI.type)
Behavior <- dplyr::filter(Meta, Fitness.measure == "behavior")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Behavior, vtype = "UB")
res <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
nullmod <- data.frame(estimate = res$b, ci.ub = res$ci.ub, ci.lb = res$ci.lb, group = c("Null"), p = res$pval, n =nrow(Behavior))
res0 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  factor(AI.type) - 1, slab = paste(dat1$Authors, dat1$Year))
res0
Behavior <- dplyr::filter(Meta, Fitness.measure == "behavior")
dat1 <- escalc(measure="SMDH", m2i=Con_Mean, sd2i=Con_SE, n2i=Study.control..n., m1i=T1_Mean, sd1i=T1_SE, n1i=Study.T1..n., data=Behavior, vtype = "UB")
res <- rma(yi, vi, data=dat1, refline = 0, method = "HE", slab = paste(dat1$Authors, dat1$Year))
nullmod <- data.frame(estimate = res$b, ci.ub = res$ci.ub, ci.lb = res$ci.lb, group = c("Null"), p = res$pval, n =nrow(Behavior))
res0 <- rma(yi, vi, data=dat1, refline = 0, method = "HE", mods =~  factor(AI.type) - 1, slab = paste(dat1$Authors, dat1$Year))
AItype <- data.frame(estimate = res0$b, ci.ub = res0$ci.ub, ci.lb = res0$ci.lb, group = c("commercial","granular", "not specified", "seed treatment", "solution", "technical grade"), p = res0$pval, n = c(length(dplyr::filter(Abundance, AI.type == "commercial")$AI.type),length(dplyr::filter(Abundance, Functional.group == "granular")$AI.type), length(dplyr::filter(Abundance, Functional.group == "not specified")$AI.type), length(dplyr::filter(Abundance, Functional.group == "seed treatment")$AI.type), length(dplyr::filter(Abundance, Functional.group == "solution")$AI.type, length(dplyr::filter(Abundance, Functional.group == "technical grade")$AI.type))))
AItype <- data.frame(estimate = res0$b, ci.ub = res0$ci.ub, ci.lb = res0$ci.lb, group = c("commercial","granular", "not specified", "seed treatment", "solution", "technical grade"), p = res0$pval, n = c(length(dplyr::filter(Abundance, AI.type == "commercial")$AI.type),length(dplyr::filter(Abundance, Functional.group == "granular")$AI.type), length(dplyr::filter(Abundance, Functional.group == "not specified")$AI.type), length(dplyr::filter(Abundance, Functional.group == "seed treatment")$AI.type), length(dplyr::filter(Abundance, Functional.group == "solution"$AI.type), length(dplyr::filter(Abundance, Functional.group == "technical grade")$AI.type)))
AItype <- data.frame(estimate = res0$b, ci.ub = res0$ci.ub, ci.lb = res0$ci.lb, group = c("commercial","granular", "not specified", "seed treatment", "solution", "technical grade"), p = res0$pval, n = c(length(dplyr::filter(Abundance, AI.type == "commercial")$AI.type),length(dplyr::filter(Abundance, Functional.group == "granular")$AI.type), length(dplyr::filter(Abundance, Functional.group == "not specified")$AI.type), length(dplyr::filter(Abundance, Functional.group == "seed treatment")$AI.type), length(dplyr::filter(Abundance, Functional.group == "solution"$AI.type), length(dplyr::filter(Abundance, Functional.group == "technical grade")$AI.type)))
AItype <- data.frame(estimate = res0$b, ci.ub = res0$ci.ub, ci.lb = res0$ci.lb, group = c("commercial","granular", "not specified", "seed treatment", "solution", "technical grade"), p = res0$pval, n = c(length(dplyr::filter(Behavior, AI.type == "commercial")$AI.type),length(dplyr::filter(Behavior, Functional.group == "granular")$AI.type), length(dplyr::filter(Behavior, Functional.group == "not specified")$AI.type), length(dplyr::filter(Behavior, Functional.group == "seed treatment")$AI.type), length(dplyr::filter(Behavior, Functional.group == "solution"$AI.type), length(dplyr::filter(Behavior, Functional.group == "technical grade")$AI.type)))
)
AItype <- data.frame(estimate = res0$b, ci.ub = res0$ci.ub, ci.lb = res0$ci.lb, group = c("commercial","granular", "not specified", "seed treatment", "solution", "technical grade"), p = res0$pval, n = c(length(dplyr::filter(Behavior, AI.type == "commercial")$AI.type),length(dplyr::filter(Behavior, Functional.group == "granular")$AI.type), length(dplyr::filter(Behavior, Functional.group == "not specified")$AI.type), length(dplyr::filter(Behavior, Functional.group == "seed treatment")$AI.type), length(dplyr::filter(Behavior, Functional.group == "solution"$AI.type), length(dplyr::filter(Behavior, Functional.group == "technical grade"$AI.type))))
)
length(dplyr::filter(Behavior, AI.type == "commercial")$AI.type
)
length(dplyr::filter(Behavior, Functional.group == "granular")$AI.type)
res0
